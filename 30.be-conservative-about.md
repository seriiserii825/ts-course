## Правило 30. Будьте консервативны в том, что отправляете, и либеральны в том, что принимаете

Это правило известно как принцип надежности, или закон Постела, сформулированный
Джоном Постелом в контексте сетевого протокола TCP:
Реализации TCP должны следовать общему принципу надежности: будьте консервативны
в том, что вы делаете, но либеральны в том, что вы получаете от других.1
Похожие правила применимы к контрактам функций.

Если функции допускают широкий спектр принимаемых вводных значений,
это нормально, но, как правило, они должны быть более конкретными в том,
что производят на выходе.

### 1) Число из разных входов → всегда number

```ts
function toNumber(v: number | string | boolean | null | undefined): number {
  if (typeof v === "number") return v;
  if (typeof v === "string" && v.trim() !== "" && !Number.isNaN(+v)) return +v;
  if (v === true) return 1;
  return 0; // консервативный, предсказуемый выход
}
```

### 2. Дата из разных входов → всегда ISO-строка

```ts
type DateInput = Date | string | number;

function toISO(d: DateInput): string {
  const date = d instanceof Date ? d : new Date(d);
  if (Number.isNaN(date.valueOf())) throw new Error("Invalid date");
  return date.toISOString(); // узкий и стабильный формат
}
```
