# –ì–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Ç–∏–ø—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ API –∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π, –∞ –Ω–µ –¥–∞–Ω–Ω—ã—Ö

–°—É–ø–µ—Ä –ø—Ä–∞–≤–∏–ª–æ. –ò–¥–µ—è: —Ç–∏–ø ‚Äî –∏–∑ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ (OpenAPI/GraphQL/Proto/JSON-Schema/DB-—Å—Ö–µ–º—ã), –∞ –Ω–µ –∏–∑ —Ä–∞–∑—Ä–æ–∑–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö. –ù–∏–∂–µ –∫–æ—Ä–æ—Ç–∫–∏–µ, –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã.

1.  –ê–Ω—Ç–∏–ø—Ä–∏–º–µ—Ä: ¬´–≤—ã–≤–æ–∂—É —Ç–∏–ø –ø–æ –æ–±—Ä–∞–∑—Ü—É –æ—Ç–≤–µ—Ç–∞¬ª
    –ü–ª–æ—Ö–æ (–ø–æ —Å—ç–º–ø–ª—É):

```ts
// sample.json (–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç)
{ "id": 1, "name": "Serii" }
// ‚Üê –≤—ã–≤–µ–¥–µ—Ç —Å–ª–∏—à–∫–æ–º —É–∑–∫–æ –∏ –ª–æ–∂–Ω–æ
type User = { id: number; name: string }; // –ø—Ä–æ–ø—É—Å—Ç–∏–ª–∏, —á—Ç–æ email –±—ã–≤–∞–µ—Ç, –∞ name –º–æ–∂–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å
```

–ß—Ç–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –≤ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ (OpenAPI):

```yaml
    User:
type: object
required: [id, email]
properties:
id: { type: string }        # id —Å—Ç—Ä–æ–∫–∞, –∞ –Ω–µ —á–∏—Å–ª–æ!
name: { type: string, nullable: true }
email: { type: string, format: email }
```

üëâ –ï—Å–ª–∏ ¬´–ø–∏—Å–∞—Ç—å –ø–æ –¥–∞–Ω–Ω—ã–º¬ª, –≤—ã –ª–µ–≥–∫–æ –ø—Ä–æ–º–∞—Ö–Ω—ë—Ç–µ—Å—å: id –Ω–µ —Ç–æ—Ç —Ç–∏–ø, email –ø–æ—Ç–µ—Ä—è–ª–∏, name nullable.

## 2) OpenAPI ‚Üí TypeScript (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è)

–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è openapi.yaml:

```yaml
paths:
  /users/{id}:
    get:
      parameters:
        - in: path
          name: id
          schema: { type: string }
          required: true
      responses:
        "200":
          description: ok
          content:
            application/json:
              schema: { $ref: "#/components/schemas/User" }
components:
  schemas:
    User:
      type: object
      required: [id, email]
      properties:
        id: { type: string }
        name: { type: string, nullable: true }
        email: { type: string, format: email }
```

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è (–æ–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞):

```bash
npx openapi-typescript openapi.yaml -o src/types/openapi.d.ts
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (—Ç–∏–ø –∏–∑ —Å–≥–µ–Ω–µ—Ä—ë–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞):

```ts
import { components } from "./types/openapi";
type User = components["schemas"]["User"];
async function getUser(id: string): Promise<User> {
  /_ ... _/;
}
```

## 3) GraphQL Schema ‚Üí —Ç–∏–ø—ã –∏ —Ö–µ–ª–ø–µ—Ä—ã

Schema (SDL):

```graphql
type User {
  id: ID!
  email: String!
  name: String
}
type Query {
  user(id: ID!): User
}
```

codegen.yml:

```yaml
schema: schema.graphql
documents: src/\*_/_.graphql
generates:
src/generated/graphql.ts:
plugins: - typescript - typescript-operations - typescript-graphql-request
```

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è:

```bash
npx graphql-codegen
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:

```ts
import { GetUserDocument, GetUserQuery } from "./generated/graphql";
// GetUserQuery["user"] —É–∂–µ —Å—Ç—Ä–æ–≥–æ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω
```

## 4) JSON Schema ‚Üí TS —Ç–∏–ø—ã

schema.json:

````json
{
  "$id": "Product",
    "type": "object",
    "required": ["sku", "priceCents"],
    "properties": {
      "sku": { "type": "string" },
      "priceCents": { "type": "integer", "minimum": 0 },
      "title": { "type": "string" }
    }
    ```
}
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è:
```bash
npx json-schema-to-typescript schema.json > src/types/product.d.ts
````

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:

```ts
import type { Product } from "./types/product";
function save(p: Product) {
  /_ ... _/;
}
```

## 5) Protobuf/gRPC ‚Üí TS

product.proto:

```ts
syntax = "3";
message Product {
  string sku = 1;
  int64 priceCents = 2;
  optional string title = 3;
}
```

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è (–ø—Ä–∏–º–µ—Ä —Å ts-proto):

```proto
protoc --plugin=./node_modules/.bin/protoc-gen-ts_proto \
--ts_proto_out=src/generated --ts_proto_opt=esModuleInterop=true \
-I . product.proto
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:

```ts
import { Product } from "./generated/product";
const p: Product = { sku: "ABC", priceCents: 1999 };
```

## 6) –°—Ö–µ–º–∞ –ë–î ‚Üí —Ç–∏–ø—ã –∫–ª–∏–µ–Ω—Ç–∞

Prisma schema:

```prisma
model User {
  id String @id @default(cuid())
    email String @unique
    name String?
}
```

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è:

```bash
npx prisma generate
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (—Å—Ç—Ä–æ–≥–∏–µ —Ç–∏–ø—ã –∏–∑ —Å—Ö–µ–º—ã):

```ts
import { PrismaClient } from "@prisma/client";
const db = new PrismaClient();
const u = await db.user.findUnique({ where: { email: "a@b.c" } });
// u?.name: string | null ‚Äî —Ç–æ—á–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ö–µ–º–µ
```

## 7) –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã —Å–æ —Å—Ö–µ–º–æ–π –≤ —Ä–∞–Ω—Ç–∞–π–º–µ (–≤–∞–ª–∏–¥–∞—Ü–∏—è + —Ç–∏–ø)

–ï—Å–ª–∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è —É–∂–µ –µ—Å—Ç—å (OpenAPI/JSON-Schema), –≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –≤–º–µ—Å—Ç–æ —Ä—É—á–Ω–æ–π –≤—ë—Ä—Å—Ç–∫–∏.
–ï—Å–ª–∏ —Å—Ö–µ–º—ã –Ω–µ—Ç ‚Äî —Å–æ–∑–¥–∞–π—Ç–µ –µ—ë –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ –∏ –≤—ã–≤–æ–¥–∏—Ç–µ —Ç–∏–ø –∏–∑ –Ω–µ—ë, –∞ –Ω–µ –Ω–∞–æ–±–æ—Ä–æ—Ç:

```ts
import { z } from "zod";
const UserSchema = z.object({
  id: z.string(),
  email: z.string().email(),
  name: z.string().nullable().optional(),
});
type User = z.infer<typeof UserSchema>;
function parseUser(json: unknown): User {
  return UserSchema.parse(json); // –∏ —Ç–∏–ø, –∏ runtime-–≤–∞–ª–∏–¥–∞—Ü–∏—è
}
```

## 8. –ú–∏–Ω–∏-—á–µ–∫–ª–∏—Å—Ç –ø–æ –ø—Ä–∞–≤–∏–ª—É 42

- ‚úÖ –ï—Å—Ç—å OpenAPI/GraphQL/JSON-Schema/Proto/DB-—Å—Ö–µ–º–∞? –ì–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Ç–∏–ø—ã –∏ –∫–ª–∏–µ–Ω—Ç—ã.
- ‚úÖ –ù–µ—Ç —Å—Ö–µ–º—ã? –°–Ω–∞—á–∞–ª–∞ –æ–ø–∏—à–∏—Ç–µ –µ—ë (Zod/TypeBox/Valibot), –ø–æ—Ç–æ–º –≤—ã–≤–µ–¥–∏—Ç–µ —Ç–∏–ø.
- ‚ùå –ù–µ –≤—ã–≤–æ–¥–∏—Ç–µ —Ç–∏–ø—ã ¬´–ø–æ –æ–¥–Ω–æ–º—É –ø—Ä–∏–º–µ—Ä—É –æ—Ç–≤–µ—Ç–∞¬ª ‚Äî —ç—Ç–æ –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –ª–æ–∂–Ω–æ.
- üîÅ –í–∫–ª—é—á–∏—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –≤ CI/–±–∏–ª–¥, —á—Ç–æ–±—ã —Ç–∏–ø—ã –æ–±–Ω–æ–≤–ª—è–ª–∏—Å—å –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏.
- –í—ã–∏–≥—Ä—ã—à: —Ç–∏–ø—ã –≤—Å–µ–≥–¥–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å–æ ¬´—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º¬ª ‚Äî —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–µ–π. –í—ã –Ω–µ –ª–æ–≤–∏—Ç–µ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω—ã, –∞ TS –∏ IDE –¥–∞—é—Ç —Ç–æ—á–Ω—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏.
